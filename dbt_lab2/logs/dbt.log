[0m00:37:40.369206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae3647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dacbee7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dacbed730>]}


============================== 00:37:40.376479 | d806ae17-ce0b-4f37-ac6e-4a6b3f4a7865 ==============================
[0m00:37:40.376479 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:37:40.378682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:37:41.488662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd806ae17-ce0b-4f37-ac6e-4a6b3f4a7865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d76ce78c0>]}
[0m00:37:41.551901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd806ae17-ce0b-4f37-ac6e-4a6b3f4a7865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7c57cf20>]}
[0m00:37:41.554073 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:37:41.664848 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:37:41.669276 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:37:41.670482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd806ae17-ce0b-4f37-ac6e-4a6b3f4a7865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d76b87200>]}
[0m00:37:42.840444 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_lab2.moving_average' (models/analytics/moving_average.sql) depends on a node named 'vantage_api' which was not found
[0m00:37:42.842633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5469308, "process_user_time": 4.482924, "process_kernel_time": 1.417247, "process_mem_max_rss": "239348", "process_in_blocks": "10792", "process_out_blocks": "2184", "command_success": false}
[0m00:37:42.844234 [debug] [MainThread]: Command `dbt run` failed at 00:37:42.844002 after 2.55 seconds
[0m00:37:42.845579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dae3647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d769e1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d76957740>]}
[0m00:37:42.846527 [debug] [MainThread]: Flushing usage events
[0m01:16:54.815273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f7061eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f4e49880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f533e900>]}


============================== 01:16:54.821891 | e115c5f5-5c5d-4f84-807d-ba64b928b1ac ==============================
[0m01:16:54.821891 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:16:54.823483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:16:55.994643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bf48ee10>]}
[0m01:16:56.076942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bf25c830>]}
[0m01:16:56.079737 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:16:56.210501 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:16:56.214720 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:16:56.215923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c4862510>]}
[0m01:16:57.588367 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m01:16:57.603292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bf0b5f70>]}
[0m01:16:57.714181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49beeb1f40>]}
[0m01:16:57.715605 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m01:16:57.716698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bef084d0>]}
[0m01:16:57.718976 [info ] [MainThread]: 
[0m01:16:57.720392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:16:57.726243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:16:57.742896 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:16:57.744390 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:16:57.745556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:58.361335 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.616 seconds
[0m01:16:58.364155 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:16:58.529802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m01:16:58.531274 [debug] [ThreadPool]: Creating schema "database: "STOCK_PRICE_DB"
schema: "RAW_DATA_ANALYTICS"
"
[0m01:16:58.538315 [debug] [ThreadPool]: Using snowflake connection "create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m01:16:58.539777 [debug] [ThreadPool]: On create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
create schema if not exists STOCK_PRICE_DB.RAW_DATA_ANALYTICS
[0m01:16:58.540943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:59.076065 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.535 seconds
[0m01:16:59.078184 [debug] [ThreadPool]: On create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m01:16:59.261736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m01:16:59.272532 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m01:16:59.273920 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
show objects in STOCK_PRICE_DB.RAW_DATA_ANALYTICS limit 10000
[0m01:16:59.274818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:00.165871 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.891 seconds
[0m01:17:00.168950 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m01:17:00.353787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49befcf170>]}
[0m01:17:00.355724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:00.357239 [info ] [MainThread]: 
[0m01:17:00.370597 [debug] [Thread-1 (]: Began running node model.dbt_lab2.moving_average
[0m01:17:00.372791 [info ] [Thread-1 (]: 1 of 2 START sql table model RAW_DATA_ANALYTICS.moving_average ................. [RUN]
[0m01:17:00.375440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now model.dbt_lab2.moving_average)
[0m01:17:00.377800 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.moving_average
[0m01:17:00.391193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.moving_average"
[0m01:17:00.412690 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.moving_average
[0m01:17:00.448909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.moving_average"
[0m01:17:00.467355 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.moving_average"
[0m01:17:00.468557 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.moving_average"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.moving_average
         as
        (

WITH ordered_data AS (
    SELECT
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY row_num
        ROWS BETWEEN 89 PRECEDING AND CURRENT ROW
    ) AS moving_average_90d
FROM ordered_data
ORDER BY symbol, date;
[0m01:17:00.469720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:01.172715 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85aed-0003-4d9c-0003-431a0004201e
[0m01:17:01.173960 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 21 unexpected ';'.
[0m01:17:01.175615 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: Close
[0m01:17:01.378232 [debug] [Thread-1 (]: Database Error in model moving_average (models/analytics/moving_average.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2/models/analytics/moving_average.sql
[0m01:17:01.380778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f53aab40>]}
[0m01:17:01.382520 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model RAW_DATA_ANALYTICS.moving_average ........ [[31mERROR[0m in 1.00s]
[0m01:17:01.383912 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.moving_average
[0m01:17:01.385059 [debug] [Thread-1 (]: Began running node model.dbt_lab2.rsi
[0m01:17:01.386969 [info ] [Thread-1 (]: 2 of 2 START sql table model RAW_DATA_ANALYTICS.rsi ............................ [RUN]
[0m01:17:01.388480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2.moving_average, now model.dbt_lab2.rsi)
[0m01:17:01.389485 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.rsi
[0m01:17:01.394450 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.rsi"
[0m01:17:01.402298 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.rsi
[0m01:17:01.406447 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.rsi"
[0m01:17:01.416581 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.rsi"
[0m01:17:01.418297 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.rsi"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.rsi
         as
        (

WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS change
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
),

average_gains_losses AS (
    SELECT
        date,
        symbol,
        close,
        change,
        AVG(CASE WHEN change > 0 THEN change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        ABS(AVG(CASE WHEN change < 0 THEN change ELSE 0 END)) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    date,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE ROUND(100 - (100 / (1 + (avg_gain / avg_loss))), 2)
    END AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date;
[0m01:17:01.419469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:02.014113 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85aed-0003-4b9d-0003-431a000282f6
[0m01:17:02.015309 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 21 unexpected ';'.
[0m01:17:02.016410 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: Close
[0m01:17:02.198038 [debug] [Thread-1 (]: Database Error in model rsi (models/analytics/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2/models/analytics/rsi.sql
[0m01:17:02.199912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e115c5f5-5c5d-4f84-807d-ba64b928b1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc2c2bd0>]}
[0m01:17:02.201246 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model RAW_DATA_ANALYTICS.rsi ................... [[31mERROR[0m in 0.81s]
[0m01:17:02.202486 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.rsi
[0m01:17:02.204573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:02.205864 [debug] [MainThread]: Connection 'model.dbt_lab2.rsi' was properly closed.
[0m01:17:02.207021 [info ] [MainThread]: 
[0m01:17:02.208171 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m01:17:02.209652 [debug] [MainThread]: Command end result
[0m01:17:02.343878 [info ] [MainThread]: 
[0m01:17:02.345673 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:17:02.346776 [info ] [MainThread]: 
[0m01:17:02.347912 [error] [MainThread]:   Database Error in model moving_average (models/analytics/moving_average.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2/models/analytics/moving_average.sql
[0m01:17:02.348944 [info ] [MainThread]: 
[0m01:17:02.350028 [error] [MainThread]:   Database Error in model rsi (models/analytics/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 21 unexpected ';'.
  compiled code at target/run/dbt_lab2/models/analytics/rsi.sql
[0m01:17:02.351451 [info ] [MainThread]: 
[0m01:17:02.352434 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:17:02.353915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.5990734, "process_user_time": 5.252113, "process_kernel_time": 1.343328, "process_mem_max_rss": "246924", "process_in_blocks": "40", "process_out_blocks": "2192", "command_success": false}
[0m01:17:02.354951 [debug] [MainThread]: Command `dbt run` failed at 01:17:02.354843 after 7.60 seconds
[0m01:17:02.355915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f5f19af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f533e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bcc2eba0>]}
[0m01:17:02.357255 [debug] [MainThread]: Flushing usage events
[0m01:21:28.350355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a82514980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a83fe2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a831759a0>]}


============================== 01:21:28.359162 | ed7e772f-beef-4222-a3c0-998e25543072 ==============================
[0m01:21:28.359162 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:21:28.360594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:21:29.335661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a81237470>]}
[0m01:21:29.401752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5158a8a0>]}
[0m01:21:29.403258 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:21:29.507867 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:21:29.612623 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:21:29.614060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a81e2cd70>]}
[0m01:21:30.903339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m01:21:30.916493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b8e9280>]}
[0m01:21:31.142335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b8b9d60>]}
[0m01:21:31.143657 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m01:21:31.144641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b8b3830>]}
[0m01:21:31.147742 [info ] [MainThread]: 
[0m01:21:31.149190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:21:31.154702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:21:31.174883 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:21:31.177001 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:21:31.178542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:31.955856 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.777 seconds
[0m01:21:31.958915 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:21:32.121149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m01:21:32.132827 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m01:21:32.134706 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
show objects in STOCK_PRICE_DB.RAW_DATA_ANALYTICS limit 10000
[0m01:21:32.135778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:33.025856 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.890 seconds
[0m01:21:33.028781 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m01:21:33.202364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a498124b0>]}
[0m01:21:33.203731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:33.204644 [info ] [MainThread]: 
[0m01:21:33.214476 [debug] [Thread-1 (]: Began running node model.dbt_lab2.moving_average
[0m01:21:33.216003 [info ] [Thread-1 (]: 1 of 2 START sql table model RAW_DATA_ANALYTICS.moving_average ................. [RUN]
[0m01:21:33.217274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now model.dbt_lab2.moving_average)
[0m01:21:33.218773 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.moving_average
[0m01:21:33.227884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.moving_average"
[0m01:21:33.236831 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.moving_average
[0m01:21:33.276628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.moving_average"
[0m01:21:33.286059 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.moving_average"
[0m01:21:33.287420 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.moving_average"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.moving_average
         as
        (

WITH ordered_data AS (
    SELECT
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY row_num
        ROWS BETWEEN 89 PRECEDING AND CURRENT ROW
    ) AS moving_average_90d
FROM ordered_data
ORDER BY symbol, date
        );
[0m01:21:33.288531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:35.450470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.162 seconds
[0m01:21:35.474597 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: Close
[0m01:21:35.637658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4be509e0>]}
[0m01:21:35.639181 [info ] [Thread-1 (]: 1 of 2 OK created sql table model RAW_DATA_ANALYTICS.moving_average ............ [[32mSUCCESS 1[0m in 2.42s]
[0m01:21:35.640407 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.moving_average
[0m01:21:35.641359 [debug] [Thread-1 (]: Began running node model.dbt_lab2.rsi
[0m01:21:35.642599 [info ] [Thread-1 (]: 2 of 2 START sql table model RAW_DATA_ANALYTICS.rsi ............................ [RUN]
[0m01:21:35.644398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2.moving_average, now model.dbt_lab2.rsi)
[0m01:21:35.645475 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.rsi
[0m01:21:35.649828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.rsi"
[0m01:21:35.658266 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.rsi
[0m01:21:35.662365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.rsi"
[0m01:21:35.672050 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.rsi"
[0m01:21:35.673641 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.rsi"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.rsi
         as
        (

WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS change
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
),

average_gains_losses AS (
    SELECT
        date,
        symbol,
        close,
        change,
        AVG(CASE WHEN change > 0 THEN change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        ABS(AVG(CASE WHEN change < 0 THEN change ELSE 0 END)) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    date,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE ROUND(100 - (100 / (1 + (avg_gain / avg_loss))), 2)
    END AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m01:21:35.674739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:21:36.051785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85af1-0003-4de3-0003-431a0003d03a
[0m01:21:36.053763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002303 (0A000): SQL compilation error: error line 29 at position 12
Sliding window frame unsupported for function ABS
[0m01:21:36.056015 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: Close
[0m01:21:36.235327 [debug] [Thread-1 (]: Database Error in model rsi (models/analytics/rsi.sql)
  002303 (0A000): SQL compilation error: error line 29 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/dbt_lab2/models/analytics/rsi.sql
[0m01:21:36.236860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed7e772f-beef-4222-a3c0-998e25543072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4bcfe3c0>]}
[0m01:21:36.238579 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model RAW_DATA_ANALYTICS.rsi ................... [[31mERROR[0m in 0.59s]
[0m01:21:36.239965 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.rsi
[0m01:21:36.242921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:36.243964 [debug] [MainThread]: Connection 'model.dbt_lab2.rsi' was properly closed.
[0m01:21:36.244800 [info ] [MainThread]: 
[0m01:21:36.245874 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m01:21:36.247296 [debug] [MainThread]: Command end result
[0m01:21:36.295530 [info ] [MainThread]: 
[0m01:21:36.296780 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:21:36.298258 [info ] [MainThread]: 
[0m01:21:36.299394 [error] [MainThread]:   Database Error in model rsi (models/analytics/rsi.sql)
  002303 (0A000): SQL compilation error: error line 29 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/dbt_lab2/models/analytics/rsi.sql
[0m01:21:36.300404 [info ] [MainThread]: 
[0m01:21:36.301303 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:21:36.303048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.094328, "process_user_time": 5.121146, "process_kernel_time": 1.403053, "process_mem_max_rss": "246328", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m01:21:36.304454 [debug] [MainThread]: Command `dbt run` failed at 01:21:36.304310 after 8.10 seconds
[0m01:21:36.305451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a815dec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a85462a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a85462a50>]}
[0m01:21:36.306421 [debug] [MainThread]: Flushing usage events
[0m01:24:17.811958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c828db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4cac66960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c81aeae0>]}


============================== 01:24:17.819268 | 810c68bb-2fb0-4447-bf6e-ca5940072482 ==============================
[0m01:24:17.819268 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:24:17.820848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models rsi --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:18.703293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c7dc45c0>]}
[0m01:24:18.759499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4937559d0>]}
[0m01:24:18.761127 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:24:18.858818 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:24:19.066428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:19.068159 [debug] [MainThread]: Partial parsing: updated file: dbt_lab2://models/analytics/rsi.sql
[0m01:24:19.300720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m01:24:19.315057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4925bff50>]}
[0m01:24:19.427160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4927ac7a0>]}
[0m01:24:19.428409 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m01:24:19.429478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c8bddb20>]}
[0m01:24:19.431854 [info ] [MainThread]: 
[0m01:24:19.433498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:24:19.435875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:24:19.451828 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:24:19.453096 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:24:19.454046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:20.163555 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.709 seconds
[0m01:24:20.167177 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:24:20.323168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m01:24:20.335647 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m01:24:20.337272 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
show objects in STOCK_PRICE_DB.RAW_DATA_ANALYTICS limit 10000
[0m01:24:20.338325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:20.898051 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.560 seconds
[0m01:24:20.901049 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m01:24:21.069790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4925ba0c0>]}
[0m01:24:21.071365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:21.072675 [info ] [MainThread]: 
[0m01:24:21.082232 [debug] [Thread-1 (]: Began running node model.dbt_lab2.rsi
[0m01:24:21.083842 [info ] [Thread-1 (]: 1 of 1 START sql table model RAW_DATA_ANALYTICS.rsi ............................ [RUN]
[0m01:24:21.085252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now model.dbt_lab2.rsi)
[0m01:24:21.086432 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.rsi
[0m01:24:21.095370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.rsi"
[0m01:24:21.103263 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.rsi
[0m01:24:21.138237 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.rsi"
[0m01:24:21.148251 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.rsi"
[0m01:24:21.149646 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.rsi"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.rsi
         as
        (

WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS change
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
),

average_gains_losses AS (
    SELECT
        date,
        symbol,
        close,
        change,
        -- Calculate average gain over the 14-day window
        AVG(CASE WHEN change > 0 THEN change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate average loss over the 14-day window
        AVG(CASE WHEN change < 0 THEN -change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    date,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE ROUND(100 - (100 / (1 + (avg_gain / avg_loss))), 2)
    END AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m01:24:21.150713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:23.047349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.897 seconds
[0m01:24:23.072638 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: Close
[0m01:24:23.243572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810c68bb-2fb0-4447-bf6e-ca5940072482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c8a326f0>]}
[0m01:24:23.245160 [info ] [Thread-1 (]: 1 of 1 OK created sql table model RAW_DATA_ANALYTICS.rsi ....................... [[32mSUCCESS 1[0m in 2.16s]
[0m01:24:23.246502 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.rsi
[0m01:24:23.248881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:23.250423 [debug] [MainThread]: Connection 'model.dbt_lab2.rsi' was properly closed.
[0m01:24:23.251480 [info ] [MainThread]: 
[0m01:24:23.252604 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m01:24:23.253923 [debug] [MainThread]: Command end result
[0m01:24:23.300530 [info ] [MainThread]: 
[0m01:24:23.301821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:24:23.302835 [info ] [MainThread]: 
[0m01:24:23.303896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:24:23.305677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5966783, "process_user_time": 3.750802, "process_kernel_time": 1.399108, "process_mem_max_rss": "247832", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m01:24:23.306795 [debug] [MainThread]: Command `dbt run` succeeded at 01:24:23.306685 after 5.60 seconds
[0m01:24:23.307700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c911a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c911aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c911bf20>]}
[0m01:24:23.308581 [debug] [MainThread]: Flushing usage events
[0m01:25:08.858834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4635c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c46b374a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c46b55850>]}


============================== 01:25:08.865945 | a8901720-27ea-4d80-a8d0-0b21124a2601 ==============================
[0m01:25:08.865945 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:08.867278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:25:09.767337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4638adb0>]}
[0m01:25:09.842860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1cc54560>]}
[0m01:25:09.845168 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:09.955730 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:10.163019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:10.164031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:10.169757 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m01:25:10.199058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c166e6ba0>]}
[0m01:25:10.312477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c14c07950>]}
[0m01:25:10.313697 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m01:25:10.314599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c14d44f80>]}
[0m01:25:10.317116 [info ] [MainThread]: 
[0m01:25:10.318547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:10.323750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:25:10.339711 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:25:10.341302 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:25:10.342263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:10.860160 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.518 seconds
[0m01:25:10.863134 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:25:11.040234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m01:25:11.052776 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m01:25:11.053897 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
show objects in STOCK_PRICE_DB.RAW_DATA_ANALYTICS limit 10000
[0m01:25:11.054725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:11.664044 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.609 seconds
[0m01:25:11.667096 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m01:25:11.838388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c14bd91c0>]}
[0m01:25:11.839933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:11.841133 [info ] [MainThread]: 
[0m01:25:11.850380 [debug] [Thread-1 (]: Began running node model.dbt_lab2.moving_average
[0m01:25:11.851761 [info ] [Thread-1 (]: 1 of 2 START sql table model RAW_DATA_ANALYTICS.moving_average ................. [RUN]
[0m01:25:11.852836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now model.dbt_lab2.moving_average)
[0m01:25:11.853683 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.moving_average
[0m01:25:11.862682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.moving_average"
[0m01:25:11.870970 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.moving_average
[0m01:25:11.903504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.moving_average"
[0m01:25:11.913651 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.moving_average"
[0m01:25:11.915004 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.moving_average"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.moving_average
         as
        (

WITH ordered_data AS (
    SELECT
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY row_num
        ROWS BETWEEN 89 PRECEDING AND CURRENT ROW
    ) AS moving_average_90d
FROM ordered_data
ORDER BY symbol, date
        );
[0m01:25:11.916314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:13.896230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.980 seconds
[0m01:25:13.922775 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: Close
[0m01:25:14.469672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1501cc20>]}
[0m01:25:14.471246 [info ] [Thread-1 (]: 1 of 2 OK created sql table model RAW_DATA_ANALYTICS.moving_average ............ [[32mSUCCESS 1[0m in 2.62s]
[0m01:25:14.472896 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.moving_average
[0m01:25:14.474733 [debug] [Thread-1 (]: Began running node model.dbt_lab2.rsi
[0m01:25:14.476092 [info ] [Thread-1 (]: 2 of 2 START sql table model RAW_DATA_ANALYTICS.rsi ............................ [RUN]
[0m01:25:14.477608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2.moving_average, now model.dbt_lab2.rsi)
[0m01:25:14.478644 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.rsi
[0m01:25:14.482862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.rsi"
[0m01:25:14.495376 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.rsi
[0m01:25:14.499074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.rsi"
[0m01:25:14.512464 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.rsi"
[0m01:25:14.513864 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.rsi"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.rsi
         as
        (

WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS change
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
),

average_gains_losses AS (
    SELECT
        date,
        symbol,
        close,
        change,
        -- Calculate average gain over the 14-day window
        AVG(CASE WHEN change > 0 THEN change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate average loss over the 14-day window
        AVG(CASE WHEN change < 0 THEN -change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    date,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE ROUND(100 - (100 / (1 + (avg_gain / avg_loss))), 2)
    END AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m01:25:14.514776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:16.494617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.980 seconds
[0m01:25:16.497992 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: Close
[0m01:25:16.682348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8901720-27ea-4d80-a8d0-0b21124a2601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c141949b0>]}
[0m01:25:16.683961 [info ] [Thread-1 (]: 2 of 2 OK created sql table model RAW_DATA_ANALYTICS.rsi ....................... [[32mSUCCESS 1[0m in 2.20s]
[0m01:25:16.685422 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.rsi
[0m01:25:16.688287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:16.689399 [debug] [MainThread]: Connection 'model.dbt_lab2.rsi' was properly closed.
[0m01:25:16.690365 [info ] [MainThread]: 
[0m01:25:16.691369 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m01:25:16.693535 [debug] [MainThread]: Command end result
[0m01:25:16.761271 [info ] [MainThread]: 
[0m01:25:16.762807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:16.764329 [info ] [MainThread]: 
[0m01:25:16.766342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:25:16.768597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.012744, "process_user_time": 3.794394, "process_kernel_time": 1.308067, "process_mem_max_rss": "239684", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m01:25:16.770303 [debug] [MainThread]: Command `dbt run` succeeded at 01:25:16.770107 after 8.01 seconds
[0m01:25:16.772086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c475fa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1688c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c14e87920>]}
[0m01:25:16.773359 [debug] [MainThread]: Flushing usage events
[0m01:25:21.505199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfcc2f08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfcedf20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfcc640b30>]}


============================== 01:25:21.512306 | d03a59d0-7dc1-4caf-b7e4-d549a0baad32 ==============================
[0m01:25:21.512306 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:21.513713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:25:22.422139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd03a59d0-7dc1-4caf-b7e4-d549a0baad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa285b3b0>]}
[0m01:25:22.476734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd03a59d0-7dc1-4caf-b7e4-d549a0baad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf97904350>]}
[0m01:25:22.478649 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:22.584600 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:22.792100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:22.793303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:22.799745 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m01:25:22.828662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd03a59d0-7dc1-4caf-b7e4-d549a0baad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf9c4c2e70>]}
[0m01:25:22.965791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd03a59d0-7dc1-4caf-b7e4-d549a0baad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf965e53a0>]}
[0m01:25:22.966935 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m01:25:22.967835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd03a59d0-7dc1-4caf-b7e4-d549a0baad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf96b09d00>]}
[0m01:25:22.969876 [info ] [MainThread]: 
[0m01:25:22.970997 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:25:22.973615 [debug] [MainThread]: Command end result
[0m01:25:23.026506 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.631189, "process_user_time": 3.438419, "process_kernel_time": 1.199917, "process_mem_max_rss": "238312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:25:23.028316 [debug] [MainThread]: Command `dbt test` succeeded at 01:25:23.028079 after 1.63 seconds
[0m01:25:23.029683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfcc640ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf96b3a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfcbf0b3e0>]}
[0m01:25:23.030836 [debug] [MainThread]: Flushing usage events
[0m01:25:27.867397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe8529be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe7211a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6bb7cb0>]}


============================== 01:25:27.875658 | fd85940a-5335-4606-9b7e-32a44d302a47 ==============================
[0m01:25:27.875658 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:27.877092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:25:28.831794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd85940a-5335-4606-9b7e-32a44d302a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe80ffa70>]}
[0m01:25:28.891095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd85940a-5335-4606-9b7e-32a44d302a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe68efc80>]}
[0m01:25:28.893618 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:29.015712 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:29.238802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:29.239992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:29.246286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m01:25:29.278239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd85940a-5335-4606-9b7e-32a44d302a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4dc5100>]}
[0m01:25:29.399391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd85940a-5335-4606-9b7e-32a44d302a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb4defc50>]}
[0m01:25:29.401092 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m01:25:29.404140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd85940a-5335-4606-9b7e-32a44d302a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb50dcb00>]}
[0m01:25:29.407582 [info ] [MainThread]: 
[0m01:25:29.409420 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:25:29.412593 [debug] [MainThread]: Command end result
[0m01:25:29.464714 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.7453889, "process_user_time": 3.40315, "process_kernel_time": 1.363279, "process_mem_max_rss": "236704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:25:29.466013 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:25:29.465868 after 1.75 seconds
[0m01:25:29.466974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe717dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe6bfa600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb555ff80>]}
[0m01:25:29.468237 [debug] [MainThread]: Flushing usage events
[0m07:17:16.404527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f6bad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ff170b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ff16420>]}


============================== 07:17:16.425615 | ccd0e393-f523-449d-92a4-da2cf33e8df1 ==============================
[0m07:17:16.425615 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:17:16.431891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:17:18.980844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff610d241d0>]}
[0m07:17:19.076316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ee7ad910>]}
[0m07:17:19.081088 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:17:19.237055 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:17:19.648126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:19.649331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:19.654546 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m07:17:19.697604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eeb23980>]}
[0m07:17:19.883052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5edc0c2c0>]}
[0m07:17:19.884436 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m07:17:19.885733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ee008bc0>]}
[0m07:17:19.889344 [info ] [MainThread]: 
[0m07:17:19.892017 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:17:19.901169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m07:17:19.927098 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m07:17:19.929409 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m07:17:19.933771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:21.222950 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.289 seconds
[0m07:17:21.229882 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m07:17:21.531910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m07:17:21.543615 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m07:17:21.546425 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
show objects in STOCK_PRICE_DB.RAW_DATA_ANALYTICS limit 10000
[0m07:17:21.548257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:17:22.230940 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.683 seconds
[0m07:17:22.233800 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m07:17:22.470015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ee342600>]}
[0m07:17:22.472142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:22.474013 [info ] [MainThread]: 
[0m07:17:22.493416 [debug] [Thread-1 (]: Began running node model.dbt_lab2.moving_average
[0m07:17:22.511988 [info ] [Thread-1 (]: 1 of 2 START sql table model RAW_DATA_ANALYTICS.moving_average ................. [RUN]
[0m07:17:22.521221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now model.dbt_lab2.moving_average)
[0m07:17:22.523491 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.moving_average
[0m07:17:22.534590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.moving_average"
[0m07:17:22.556024 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.moving_average
[0m07:17:22.611300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.moving_average"
[0m07:17:22.633459 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.moving_average"
[0m07:17:22.635052 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.moving_average"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.moving_average
         as
        (

WITH ordered_data AS (
    SELECT
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY row_num
        ROWS BETWEEN 89 PRECEDING AND CURRENT ROW
    ) AS moving_average_90d
FROM ordered_data
ORDER BY symbol, date
        );
[0m07:17:22.636287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:25.876842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.240 seconds
[0m07:17:25.914624 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: Close
[0m07:17:26.135728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ff82f60>]}
[0m07:17:26.138750 [info ] [Thread-1 (]: 1 of 2 OK created sql table model RAW_DATA_ANALYTICS.moving_average ............ [[32mSUCCESS 1[0m in 3.61s]
[0m07:17:26.140784 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.moving_average
[0m07:17:26.142956 [debug] [Thread-1 (]: Began running node model.dbt_lab2.rsi
[0m07:17:26.148924 [info ] [Thread-1 (]: 2 of 2 START sql table model RAW_DATA_ANALYTICS.rsi ............................ [RUN]
[0m07:17:26.150972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2.moving_average, now model.dbt_lab2.rsi)
[0m07:17:26.152323 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.rsi
[0m07:17:26.155934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.rsi"
[0m07:17:26.167546 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.rsi
[0m07:17:26.176474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.rsi"
[0m07:17:26.192485 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.rsi"
[0m07:17:26.194416 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.rsi"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.rsi
         as
        (

WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS change
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
),

average_gains_losses AS (
    SELECT
        date,
        symbol,
        close,
        change,
        -- Calculate average gain over the 14-day window
        AVG(CASE WHEN change > 0 THEN change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate average loss over the 14-day window
        AVG(CASE WHEN change < 0 THEN -change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    date,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE ROUND(100 - (100 / (1 + (avg_gain / avg_loss))), 2)
    END AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m07:17:26.196070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:28.371309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.175 seconds
[0m07:17:28.376271 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: Close
[0m07:17:28.643193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd0e393-f523-449d-92a4-da2cf33e8df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5edf06cc0>]}
[0m07:17:28.647616 [info ] [Thread-1 (]: 2 of 2 OK created sql table model RAW_DATA_ANALYTICS.rsi ....................... [[32mSUCCESS 1[0m in 2.49s]
[0m07:17:28.649853 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.rsi
[0m07:17:28.652936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:28.654173 [debug] [MainThread]: Connection 'model.dbt_lab2.rsi' was properly closed.
[0m07:17:28.655614 [info ] [MainThread]: 
[0m07:17:28.657335 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.76 seconds (8.76s).
[0m07:17:28.660118 [debug] [MainThread]: Command end result
[0m07:17:28.745618 [info ] [MainThread]: 
[0m07:17:28.748443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:17:28.752146 [info ] [MainThread]: 
[0m07:17:28.763731 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:17:28.774012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.616457, "process_user_time": 6.473731, "process_kernel_time": 2.671539, "process_mem_max_rss": "223796", "process_in_blocks": "82344", "process_out_blocks": "2192"}
[0m07:17:28.777993 [debug] [MainThread]: Command `dbt run` succeeded at 07:17:28.777708 after 12.62 seconds
[0m07:17:28.779655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fb60830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5edf06c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f458b530>]}
[0m07:17:28.782253 [debug] [MainThread]: Flushing usage events
[0m07:17:36.061938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff8405550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff827f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffa5ba4b0>]}


============================== 07:17:36.079304 | 5bab64a3-4ebd-4c16-8a93-ace00ddfe612 ==============================
[0m07:17:36.079304 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:17:36.081320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:17:37.385945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bab64a3-4ebd-4c16-8a93-ace00ddfe612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffba3aab0>]}
[0m07:17:37.469691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bab64a3-4ebd-4c16-8a93-ace00ddfe612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfdc97b890>]}
[0m07:17:37.471639 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:17:37.598641 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:17:37.892162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:37.894103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:37.902475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m07:17:37.938192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bab64a3-4ebd-4c16-8a93-ace00ddfe612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd6aa2480>]}
[0m07:17:38.116410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bab64a3-4ebd-4c16-8a93-ace00ddfe612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd5db0f80>]}
[0m07:17:38.120498 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m07:17:38.123652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bab64a3-4ebd-4c16-8a93-ace00ddfe612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd5fcfbf0>]}
[0m07:17:38.129591 [info ] [MainThread]: 
[0m07:17:38.131273 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:17:38.133751 [debug] [MainThread]: Command end result
[0m07:17:38.199539 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3096538, "process_user_time": 4.44807, "process_kernel_time": 0.917539, "process_mem_max_rss": "218444", "process_in_blocks": "1184", "process_out_blocks": "0"}
[0m07:17:38.201499 [debug] [MainThread]: Command `dbt test` succeeded at 07:17:38.201213 after 2.31 seconds
[0m07:17:38.202862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff7e08b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff84075c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd6232420>]}
[0m07:17:38.204088 [debug] [MainThread]: Flushing usage events
[0m07:17:45.051911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea2aa0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea2f993a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea43ae4e0>]}


============================== 07:17:45.059174 | 04aaaf63-01a6-4736-a959-ec74c45e6eeb ==============================
[0m07:17:45.059174 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:17:45.069145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:17:46.329291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04aaaf63-01a6-4736-a959-ec74c45e6eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea37e31a0>]}
[0m07:17:46.408132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04aaaf63-01a6-4736-a959-ec74c45e6eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee87de11f0>]}
[0m07:17:46.410176 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:17:46.540951 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:17:46.813110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:46.816564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:46.829196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m07:17:46.867836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04aaaf63-01a6-4736-a959-ec74c45e6eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8d35efc0>]}
[0m07:17:47.032477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04aaaf63-01a6-4736-a959-ec74c45e6eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee85395070>]}
[0m07:17:47.033839 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m07:17:47.035139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04aaaf63-01a6-4736-a959-ec74c45e6eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8539ae70>]}
[0m07:17:47.038464 [info ] [MainThread]: 
[0m07:17:47.040525 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:17:47.043503 [debug] [MainThread]: Command end result
[0m07:17:47.109701 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.2071285, "process_user_time": 4.340086, "process_kernel_time": 0.863998, "process_mem_max_rss": "214004", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m07:17:47.115286 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:17:47.114374 after 2.21 seconds
[0m07:17:47.118545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea2e6fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feea4bb7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee8622db50>]}
[0m07:17:47.120820 [debug] [MainThread]: Flushing usage events
[0m07:23:35.014523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc996293740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc995c7d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc998445d00>]}


============================== 07:23:35.029044 | e94f1f5b-80ed-4b62-b4dc-06e5a6490071 ==============================
[0m07:23:35.029044 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:23:35.033247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:23:36.625630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97b8819d0>]}
[0m07:23:36.734901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9963790a0>]}
[0m07:23:36.737053 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:23:36.890825 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:23:37.037227 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:23:37.038741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99555f710>]}
[0m07:23:38.884972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m07:23:38.904514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc973e47770>]}
[0m07:23:39.189317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc973ca30e0>]}
[0m07:23:39.191197 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m07:23:39.193271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972bd6c90>]}
[0m07:23:39.202464 [info ] [MainThread]: 
[0m07:23:39.205575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:23:39.213339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m07:23:39.232408 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m07:23:39.235027 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m07:23:39.236481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:40.015309 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.779 seconds
[0m07:23:40.017883 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m07:23:40.202229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m07:23:40.205304 [debug] [ThreadPool]: Creating schema "database: "STOCK_PRICE_DB"
schema: "RAW_DATA_ANALYTICS"
"
[0m07:23:40.212800 [debug] [ThreadPool]: Using snowflake connection "create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m07:23:40.214111 [debug] [ThreadPool]: On create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
create schema if not exists STOCK_PRICE_DB.RAW_DATA_ANALYTICS
[0m07:23:40.214934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:40.816586 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.601 seconds
[0m07:23:40.819049 [debug] [ThreadPool]: On create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m07:23:41.029651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS)
[0m07:23:41.040638 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"
[0m07:23:41.042399 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS"} */
show objects in STOCK_PRICE_DB.RAW_DATA_ANALYTICS limit 10000
[0m07:23:41.047584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:41.651958 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.605 seconds
[0m07:23:41.655235 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS: Close
[0m07:23:41.859202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc973c2ee10>]}
[0m07:23:41.861876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:23:41.864657 [info ] [MainThread]: 
[0m07:23:41.875203 [debug] [Thread-1 (]: Began running node model.dbt_lab2.moving_average
[0m07:23:41.881908 [info ] [Thread-1 (]: 1 of 2 START sql table model RAW_DATA_ANALYTICS.moving_average ................. [RUN]
[0m07:23:41.884854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_ANALYTICS, now model.dbt_lab2.moving_average)
[0m07:23:41.886827 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.moving_average
[0m07:23:41.897180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.moving_average"
[0m07:23:41.908206 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.moving_average
[0m07:23:41.957823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.moving_average"
[0m07:23:41.966136 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.moving_average"
[0m07:23:41.967396 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.moving_average"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.moving_average
         as
        (

WITH ordered_data AS (
    SELECT
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY row_num
        ROWS BETWEEN 89 PRECEDING AND CURRENT ROW
    ) AS moving_average_90d
FROM ordered_data
ORDER BY symbol, date
        );
[0m07:23:41.968420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:43.488809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.520 seconds
[0m07:23:43.525085 [debug] [Thread-1 (]: On model.dbt_lab2.moving_average: Close
[0m07:23:43.728067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9782c0d10>]}
[0m07:23:43.729580 [info ] [Thread-1 (]: 1 of 2 OK created sql table model RAW_DATA_ANALYTICS.moving_average ............ [[32mSUCCESS 1[0m in 1.84s]
[0m07:23:43.730867 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.moving_average
[0m07:23:43.731835 [debug] [Thread-1 (]: Began running node model.dbt_lab2.rsi
[0m07:23:43.732771 [info ] [Thread-1 (]: 2 of 2 START sql table model RAW_DATA_ANALYTICS.rsi ............................ [RUN]
[0m07:23:43.733834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab2.moving_average, now model.dbt_lab2.rsi)
[0m07:23:43.734710 [debug] [Thread-1 (]: Began compiling node model.dbt_lab2.rsi
[0m07:23:43.738694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab2.rsi"
[0m07:23:43.755462 [debug] [Thread-1 (]: Began executing node model.dbt_lab2.rsi
[0m07:23:43.763031 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lab2.rsi"
[0m07:23:43.770187 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_lab2.rsi"
[0m07:23:43.772228 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab2", "target_name": "dev", "node_id": "model.dbt_lab2.rsi"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_ANALYTICS.rsi
         as
        (

WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS change
    FROM STOCK_PRICE_DB.RAW_DATA.vantage_api
),

average_gains_losses AS (
    SELECT
        date,
        symbol,
        close,
        change,
        -- Calculate average gain over the 14-day window
        AVG(CASE WHEN change > 0 THEN change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate average loss over the 14-day window
        AVG(CASE WHEN change < 0 THEN -change ELSE 0 END) OVER (
            PARTITION BY symbol
            ORDER BY date
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    date,
    symbol,
    close,
    avg_gain,
    avg_loss,
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE ROUND(100 - (100 / (1 + (avg_gain / avg_loss))), 2)
    END AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m07:23:43.773509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:45.553011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m07:23:45.558620 [debug] [Thread-1 (]: On model.dbt_lab2.rsi: Close
[0m07:23:45.741095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94f1f5b-80ed-4b62-b4dc-06e5a6490071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97810e840>]}
[0m07:23:45.750927 [info ] [Thread-1 (]: 2 of 2 OK created sql table model RAW_DATA_ANALYTICS.rsi ....................... [[32mSUCCESS 1[0m in 2.01s]
[0m07:23:45.754965 [debug] [Thread-1 (]: Finished running node model.dbt_lab2.rsi
[0m07:23:45.760064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:45.761641 [debug] [MainThread]: Connection 'model.dbt_lab2.rsi' was properly closed.
[0m07:23:45.762614 [info ] [MainThread]: 
[0m07:23:45.763512 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m07:23:45.764810 [debug] [MainThread]: Command end result
[0m07:23:45.829680 [info ] [MainThread]: 
[0m07:23:45.831271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:23:45.832401 [info ] [MainThread]: 
[0m07:23:45.833465 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:23:45.835678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.967558, "process_user_time": 6.493283, "process_kernel_time": 2.201455, "process_mem_max_rss": "213520", "process_in_blocks": "480", "process_out_blocks": "8"}
[0m07:23:45.836953 [debug] [MainThread]: Command `dbt run` succeeded at 07:23:45.836702 after 10.97 seconds
[0m07:23:45.839539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9962f32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97854bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc973c6cad0>]}
[0m07:23:45.840879 [debug] [MainThread]: Flushing usage events
[0m07:23:52.101087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cedfeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cedfecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cedfcc20>]}


============================== 07:23:52.112426 | c1252a98-a7f9-4146-bb29-8b227662c2a9 ==============================
[0m07:23:52.112426 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:23:52.116608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:23:53.310908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1252a98-a7f9-4146-bb29-8b227662c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b079c830>]}
[0m07:23:53.386965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1252a98-a7f9-4146-bb29-8b227662c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b0cd37d0>]}
[0m07:23:53.389671 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:23:53.508443 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:23:53.782501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:23:53.784823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:23:53.791495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m07:23:53.831572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1252a98-a7f9-4146-bb29-8b227662c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b3d08290>]}
[0m07:23:54.011992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1252a98-a7f9-4146-bb29-8b227662c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85abfa13a0>]}
[0m07:23:54.013150 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m07:23:54.014207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1252a98-a7f9-4146-bb29-8b227662c2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b02b70e0>]}
[0m07:23:54.016799 [info ] [MainThread]: 
[0m07:23:54.018015 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:23:54.021639 [debug] [MainThread]: Command end result
[0m07:23:54.089522 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1416612, "process_user_time": 4.145458, "process_kernel_time": 0.841107, "process_mem_max_rss": "199052", "process_in_blocks": "1304", "process_out_blocks": "0"}
[0m07:23:54.091150 [debug] [MainThread]: Command `dbt test` succeeded at 07:23:54.090912 after 2.14 seconds
[0m07:23:54.092467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ce1cb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85abf87fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ce18e840>]}
[0m07:23:54.098172 [debug] [MainThread]: Flushing usage events
[0m07:23:59.654335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bd11f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bea13a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bcff2030>]}


============================== 07:23:59.676854 | 4f15ac65-224f-49d5-8f14-0d1584c8ef44 ==============================
[0m07:23:59.676854 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:23:59.678266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:24:01.031715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f15ac65-224f-49d5-8f14-0d1584c8ef44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f669b74b020>]}
[0m07:24:01.081305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f15ac65-224f-49d5-8f14-0d1584c8ef44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bbf43f80>]}
[0m07:24:01.083052 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:24:01.174247 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:24:01.362120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:24:01.363239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:24:01.368599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_lab2.example
[0m07:24:01.394358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f15ac65-224f-49d5-8f14-0d1584c8ef44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f669b5f12b0>]}
[0m07:24:01.517045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f15ac65-224f-49d5-8f14-0d1584c8ef44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f669b2e7b00>]}
[0m07:24:01.518655 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m07:24:01.519923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f15ac65-224f-49d5-8f14-0d1584c8ef44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f669b4b7ad0>]}
[0m07:24:01.523304 [info ] [MainThread]: 
[0m07:24:01.524620 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:24:01.526993 [debug] [MainThread]: Command end result
[0m07:24:01.567841 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.1495047, "process_user_time": 4.183772, "process_kernel_time": 0.720989, "process_mem_max_rss": "200064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:24:01.569298 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:24:01.569104 after 2.15 seconds
[0m07:24:01.570422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a050ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bcff2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bcff1f70>]}
[0m07:24:01.574364 [debug] [MainThread]: Flushing usage events
